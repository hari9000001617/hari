<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title> SQLQuery&amp;() </title>
<script type="text/javascript" src="open_parent.js"></script>
<link rel="stylesheet" type="text/css" href="pkc.css">
<link rel="stylesheet" type="text/css" href="stylesheet.css">
<meta name="description" content="Configurer's Reference Guide for Singleview Convergent Billing 9.1 ">
<script language="javascript" type="text/javascript" src="dhtml_toc.js"></script>
<script language="JavaScript">
<!--

document.onkeydown = checkChangePage;
function checkChangePage(e)
{
   if (!e) var e = window.event;
   // Don't put the following into the first page
   if ((e.ctrlKey && (e.keyCode == 37))) {
      // Ctrl-Left Arrow was pressed or Page up key pressed at the top of the page
      document.location.href = "13806.htm";
   } else
   // Don't put the following into the late page for a document
   if ((e.ctrlKey && (e.keyCode == 39))) {
      // Ctrl-Right Arrow was pressed or Page down key pressed and at the bottom of the page
      document.location.href = "13808.htm";
   }
}

function MM_swapImgRestore() { //v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
}

function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_findObj(n, d) { //v4.0
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && document.getElementById) x=document.getElementById(n); return x;
}

function MM_swapImage() { //v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
}

function printpage()
{
	window.print();
}
//-->
</script>
</head>
<body onload="loadParent();MM_preloadImages('left_down.gif','right_down.gif','index_down.gif','contents_down.gif','search_down.gif','print_down.gif');if (isTOCLoaded()) {expand('11007');expand('10992');highlight('13807')}">
<div class="menubar">  <table width="100%" border="0" cellspacing="0" cellpadding="0">    <tr valign="middle">      <td width="70">        <a href="13806.htm" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('left','','left_down.gif',1)">        <img name="left" border="0" src="left_up.gif" width="26" height="26" alt="Previous topic" title="Previous topic"></a>        <a href="13808.htm" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('right','','right_down.gif',1)">        <img name="right" border="0" src="right_up.gif" width="26" height="26" alt="Next topic" title="Next topic"></a></td>        <td class="bodytext">Configurer's Reference Guide for Singleview Convergent Billing 9.1 </td>        <td width="40">        <div align="center">        <a href="javascript:printpage();" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('print','','print_down.gif',1)">        <img name="print" border="0" src="print_up.gif" width="26" height="26" alt="Print this page" title="Print this page"></a>      </div>       </td></tr>  </table></div><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td width="100%">
<h3 class="heading3">SQLQuery&amp;()</h3>
</td><td class="feedback"><p><a href="mailto:ipoint@csgi.com?subject=Feedback on Topic 'SQLQuery&amp;()' (13807)"><img border=0 src="email.png" alt="Provide feedback on this topic"></a></p></td></tr></table><p class="syntaxheading">Syntax</p>
<pre class="unixinputp">SQLQuery&amp;(    const&nbsp;SQLText$,    const&nbsp;ParamNames$[],    const&nbsp;ParamValues?[],    FromRow&amp;,    ToRow&amp;,    var&nbsp;Rows?[])</pre>
<p class="bodytext">&nbsp;</p>
<p class="syntaxheading">Description</p>
<p class="bodytext">Prepares the specified SQL statement, binds any specified parameters, executes the SQL statement, and fetches the specified range of rows.</p>
<p class="syntaxheading">Attributes</p>
<table class="tableintopic" width="282" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="tablebodytext"><span class="bold">Application Environment</span></p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">Any</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="tablebodytext"><span class="bold">Context</span></p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">Any</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="tablebodytext"><span class="bold">Method</span></p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">Local</p>
</td>
</tr>

</table>
<p class="bodytext">&nbsp;</p>
<table class="tableintopic" width="696" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<td class="tableheading" style="border:1px solid #010101;" width="144"><p class="tableheading">Parameter</p>
</td>
<td class="tableheading" style="border:1px solid #010101;" width="552"><p class="tableheading">Description</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="144"><p class="tablebodytext"><span class="unixoutputc">SQLText$</span></p>
</td>
<td style="border:1px solid #010101;" width="552"><p class="tablebodytext">In:  SQL query to be performed.</p>
<p class="tablebodytext">Parameter names in the query text should be preceded by a ':'.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="144"><p class="tablebodytext"><span class="unixoutputc">ParamNames$[]</span></p>
</td>
<td style="border:1px solid #010101;" width="552"><p class="tablebodytext">In:  List of parameter names in the query.</p>
<p class="tablebodytext">Parameter names in this array should not include the ':'.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="144"><p class="tablebodytext"><span class="unixoutputc">ParamValues?[]</span></p>
</td>
<td style="border:1px solid #010101;" width="552"><p class="tablebodytext">In:  Corresponding values to assign to each parameter name in the query.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="144"><p class="tablebodytext"><span class="unixoutputc">FromRow&amp;</span></p>
</td>
<td style="border:1px solid #010101;" width="552"><p class="tablebodytext">In:  First row in the query result set to be returned ('1' is the first row).</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="144"><p class="tablebodytext"><span class="unixoutputc">ToRow&amp;</span></p>
</td>
<td style="border:1px solid #010101;" width="552"><p class="tablebodytext">In.  Last row to be returned.</p>
<p class="tablebodytext">If the values 0 or 1 are specified, all rows from <span class="unixoutputc">FromRow&amp;</span> are returned.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="144"><p class="tablebodytext"><span class="unixoutputc">Rows?[]</span></p>
</td>
<td style="border:1px solid #010101;" width="552"><p class="tablebodytext">Out:  Two-dimensional array containing the rows specified in the range in <span class="unixoutputc">FromRow&amp;</span> and <span class="unixoutputc">ToRow&amp;</span> of the query (in [Row&amp;][Column&amp;] order).</p>
<p class="tablebodytext"><span class="unixoutputc">Row&amp;=0</span> corresponds to the row specified by <span class="unixoutputc">FromRow&amp;</span> of the query.</p>
</td>
</tr>

</table>
<p class="bodytext">&nbsp;</p>
<p class="syntaxheading">Returns</p>
<p class="bodytext">Number of rows contained in the hash; otherwise, 0 if there are no rows.  If there are rows after the <span class="unixoutputc">ToRow&amp;</span> value, this implies that the module must do an additional fetch after the <span class="unixoutputc">ToRow&amp;</span> value to get additional data (if this is wanted), and 1 is added to the returned value.</p>
<p class="bodytext">If the execution of the preparation, any of the binds, or the query itself fails, an error is raised.  An error is also raised if <span class="unixoutputc">ToRow&amp;</span> &gt; 0 and <span class="unixoutputc">ToRow&amp;</span> &lt; <span class="unixoutputc">FromRow&amp;</span>, or if <span class="unixoutputc">FromRow&amp;</span> &lt;1.</p>
<p class="syntaxheading">Remarks</p>
<p class="bodytext">The function returns the row data in the <span class="unixoutputc">Rows?[]</span> parameter.  It is identical to <span class="unixoutputc"><a id="h40711" class="jump" title="biSQLQuery&amp;()" href="12133.htm" target="_self">biSQLQuery&amp;()</a></span>, except that the query is performed from within the current process (rather than causing a TRE call to a server to perform the query.  The following is true for this function:</p>
<ul class="listbullet"><li class="listbullet">The function can only be used in processes that have an SQL server connection to the database.  For this reason, the function cannot be called from within EPM code running in the <span class="unixoutputc">ecp</span> process or the Convergent Billing client.</li><li class="listbullet">The transactional behaviour of the query is dependent on the process in which it is run.  If called from within a trerwdb process, it is part of a global transaction managed by the TRE.  If called from within a trerodb process (or most other processes), it is a part of a locally managed transaction.</li><li class="listbullet">The query is executed within the current process, so it has a lower overhead and better performance than the same query executed using <span class="unixoutputc">biSQLQuery&amp;()</span>.</li><li class="listbullet">If running from within a global transaction, it is possible to recover from errors raised by this function without aborting the transaction.  An error raised by any <span class="unixoutputc"><a id="h40710" class="jump" title="biSQLQueryRW&amp;()" href="12135.htm" target="_self">biSQLQueryRW&amp;()</a></span> call causes the transaction to be aborted.</li></ul><p class="bodytext">Oracle Call Interface (OCI) handles are cached for reuse when executing SQL statements.  The number of handles is determined by the value of the <span class="unixoutputc">$ATA_SQLCACHESIZE</span> environment variable, or 30 if there is no value specified for <span class="unixoutputc">$ATA_SQLCACHESIZE</span>.  Caching OCI handles can improve performance where many repetitive <span class="unixoutputc">SQLQuery&amp;()</span> calls are being made.  The number of OCI handles cached for a process can be changed by calling <span class="unixoutputc"><a id="h62675" class="jump" title="SQLCacheSize&amp;()" href="13799.htm" target="_self">SQLCacheSize&amp;()</a></span>.</p>


<br><div class="menubar">  <table width="100%" border="0" cellspacing="0" cellpadding="0">    <tr valign="middle">      <td width="70">        <a href="13806.htm" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('left','','left_down.gif',1)">        <img name="left" border="0" src="left_up.gif" width="26" height="26" alt="Previous topic" title="Previous topic"></a>        <a href="13808.htm" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('right','','right_down.gif',1)">        <img name="right" border="0" src="right_up.gif" width="26" height="26" alt="Next topic" title="Next topic"></a></td>        <td class="bodytext">Configurer's Reference Guide for Singleview Convergent Billing 9.1 </td>        <td width="40">        <div align="center">        <a href="javascript:printpage();" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('print','','print_down.gif',1)">        <img name="print" border="0" src="print_up.gif" width="26" height="26" alt="Print this page" title="Print this page"></a>      </div>       </td></tr>  </table></div></body>
</html>


