<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title> SQLExecute&amp;() </title>
<script type="text/javascript" src="open_parent.js"></script>
<link rel="stylesheet" type="text/css" href="pkc.css">
<link rel="stylesheet" type="text/css" href="stylesheet.css">
<meta name="description" content="Configurer's Reference Guide for Singleview Convergent Billing 9.1 ">
<script language="javascript" type="text/javascript" src="dhtml_toc.js"></script>
<script language="JavaScript">
<!--

document.onkeydown = checkChangePage;
function checkChangePage(e)
{
   if (!e) var e = window.event;
   // Don't put the following into the first page
   if ((e.ctrlKey && (e.keyCode == 37))) {
      // Ctrl-Left Arrow was pressed or Page up key pressed at the top of the page
      document.location.href = "52250.htm";
   } else
   // Don't put the following into the late page for a document
   if ((e.ctrlKey && (e.keyCode == 39))) {
      // Ctrl-Right Arrow was pressed or Page down key pressed and at the bottom of the page
      document.location.href = "13804.htm";
   }
}

function MM_swapImgRestore() { //v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
}

function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_findObj(n, d) { //v4.0
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && document.getElementById) x=document.getElementById(n); return x;
}

function MM_swapImage() { //v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
}

function printpage()
{
	window.print();
}
//-->
</script>
</head>
<body onload="loadParent();MM_preloadImages('left_down.gif','right_down.gif','index_down.gif','contents_down.gif','search_down.gif','print_down.gif');if (isTOCLoaded()) {expand('11007');expand('10992');highlight('13803')}">
<div class="menubar">  <table width="100%" border="0" cellspacing="0" cellpadding="0">    <tr valign="middle">      <td width="70">        <a href="52250.htm" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('left','','left_down.gif',1)">        <img name="left" border="0" src="left_up.gif" width="26" height="26" alt="Previous topic" title="Previous topic"></a>        <a href="13804.htm" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('right','','right_down.gif',1)">        <img name="right" border="0" src="right_up.gif" width="26" height="26" alt="Next topic" title="Next topic"></a></td>        <td class="bodytext">Configurer's Reference Guide for Singleview Convergent Billing 9.1 </td>        <td width="40">        <div align="center">        <a href="javascript:printpage();" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('print','','print_down.gif',1)">        <img name="print" border="0" src="print_up.gif" width="26" height="26" alt="Print this page" title="Print this page"></a>      </div>       </td></tr>  </table></div><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td width="100%">
<h3 class="heading3">SQLExecute&amp;()</h3>
</td><td class="feedback"><p><a href="mailto:ipoint@csgi.com?subject=Feedback on Topic 'SQLExecute&amp;()' (13803)"><img border=0 src="email.png" alt="Provide feedback on this topic"></a></p></td></tr></table><p class="syntaxheading">Syntax</p>
<pre class="unixinputp">SQLExecute&amp;(    const&nbsp;SQLText$,    const&nbsp;ParamNames$[],    const&nbsp;ParamValues?[])</pre>
<p class="bodytext">&nbsp;</p>
<p class="syntaxheading">Description</p>
<p class="bodytext">Prepares the specified SQL statement (typically insert, update, or delete), binds any specified parameters, and executes the SQL statement.</p>
<p class="syntaxheading">Attributes</p>
<table class="tableintopic" width="288" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="187"><p class="tablebodytext"><span class="bold">Application Environment</span></p>
</td>
<td style="border:1px solid #010101;" width="101"><p class="tablebodytext">Any</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="187"><p class="tablebodytext"><span class="bold">Context</span></p>
</td>
<td style="border:1px solid #010101;" width="101"><p class="tablebodytext">Any</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="187"><p class="tablebodytext"><span class="bold">Method</span></p>
</td>
<td style="border:1px solid #010101;" width="101"><p class="tablebodytext">Local</p>
</td>
</tr>

</table>
<p class="bodytext">&nbsp;</p>
<table class="tableintopic" width="696" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<td class="tableheading" style="border:1px solid #010101;" width="128"><p class="tableheading">Parameter</p>
</td>
<td class="tableheading" style="border:1px solid #010101;" width="568"><p class="tableheading">Description</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="128"><p class="tablebodytext"><span class="unixoutputc">SQLText$</span></p>
</td>
<td style="border:1px solid #010101;" width="568"><p class="tablebodytext">In:  SQL query to be performed.</p>
<p class="tablebodytext">Parameter names in the query text should be preceded by a ':'.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="128"><p class="tablebodytext"><span class="unixoutputc">ParamNames$[]</span></p>
</td>
<td style="border:1px solid #010101;" width="568"><p class="tablebodytext">In:  List of parameter names in the query.</p>
<p class="tablebodytext">Parameter names in this array should not include the ':'.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="128"><p class="tablebodytext"><span class="unixoutputc">ParamValues?[]</span></p>
</td>
<td style="border:1px solid #010101;" width="568"><p class="tablebodytext">In:  Corresponding values to assign to each parameter name in the query.</p>
<p class="tablebodytext">Array elements can be used.  For information about array elements, refer to <span class="referrals">Remarks</span> below.</p>
</td>
</tr>

</table>
<p class="bodytext">&nbsp;</p>
<p class="syntaxheading">Returns</p>
<p class="bodytext">Number of rows affected by the statement (can be zero).  If the execution of the preparation, any of the binds, or the query itself fails, an error is raised.</p>
<p class="syntaxheading">Remarks</p>
<p class="bodytext">This function is similar to the <span class="unixoutputc">biSQLExecute&amp;()</span> function, except that the statement is executed from within the current process (rather than causing a TRE call to a server to execute the statement) and <span class="unixoutputc">ParamValues?[]</span> can contain array elements.  The following is true for this function:</p>
<ul class="listbullet"><li class="listbullet">The function can only be used in processes that have an SQL server connection to the database.  For this reason, the function cannot be called from within EPM code running in the <span class="unixoutputc">ecp</span> process or the Convergent Billing client.</li><li class="listbullet">The transactional behaviour of the query is dependent on the process in which it is run.  If called from within a trerwdb process, it is part of a global transaction managed by the TRE.  If called from within a trerodb process (or most other processes), it is a part of a locally managed transaction.</li><li class="listbullet">Since the query is executed within the current process, it has a lower overhead and better performance than the same query executed using the <span class="unixoutputc">biSQLExecute&amp;()</span> function.</li></ul><p class="bodytext">If running from within a global transaction, it is possible to recover from errors raised by this function without aborting the transaction.  An error raised by any <span class="unixoutputc">biSQLExecute&amp;()</span> call causes the transaction to be aborted.</p>
<p class="bodytext"><span class="unixoutputc">ParamNames$[]</span> holds the variable names used in the <span class="unixoutputc">SQLText$</span> parameter.  Valid parameter names are identified in <span class="unixoutputc">SQLText$</span> by a ':' followed by a name.  Only the variable name is included in <span class="unixoutputc">ParamNames$[]</span> (that is, without the colon).</p>
<p class="bodytext">The parameter values for the variable names are passed in the <span class="unixoutputc">ParamValues?[]</span> array.  The elements of <span class="unixoutputc">ParamValues?[]</span> must be either all base elements (for example, string or integer) or all array elements (for example, string array or integer array).  If array elements are used, all array elements must have the same number of values.  The effect of using array elements is the same as executing the SQL statement once for every row in the arrays.  Blob types are not supported by array operations.</p>
<p class="bodytext">The following is an example using array elements:</p>
<p class="bodytext"><span class="unixoutputc"># Delete rows from test_table that have a test_table_ID of 1, 2 and 3</span><br><span class="unixoutputc"># and are effective for the current date. </span><br><span class="unixoutputc">var&nbsp;lTestIds&amp;[] := [ 1,2,3 ];</span><br><span class="unixoutputc">var&nbsp;lNow~ := current_date();</span><br><span class="unixoutputc">var&nbsp;lEffectiveDates~[] := [ lNow~, lNow~, lNow~ ];</span><br><span class="unixoutputc">SQLExecute&amp;('DELETE FROM test_table WHERE test_table_ID = :ID AND</span><br><span class="unixoutputc">            :eff_date BETWEEN effective_start_date AND effective_end_date', </span><br><span class="unixoutputc">            [ 'ID', 'eff_date' ], </span><br><span class="unixoutputc">            [ lTestIds&amp;[], lEffectiveDates~[] ] );</span></p>


<br><div class="menubar">  <table width="100%" border="0" cellspacing="0" cellpadding="0">    <tr valign="middle">      <td width="70">        <a href="52250.htm" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('left','','left_down.gif',1)">        <img name="left" border="0" src="left_up.gif" width="26" height="26" alt="Previous topic" title="Previous topic"></a>        <a href="13804.htm" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('right','','right_down.gif',1)">        <img name="right" border="0" src="right_up.gif" width="26" height="26" alt="Next topic" title="Next topic"></a></td>        <td class="bodytext">Configurer's Reference Guide for Singleview Convergent Billing 9.1 </td>        <td width="40">        <div align="center">        <a href="javascript:printpage();" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('print','','print_down.gif',1)">        <img name="print" border="0" src="print_up.gif" width="26" height="26" alt="Print this page" title="Print this page"></a>      </div>       </td></tr>  </table></div></body>
</html>


